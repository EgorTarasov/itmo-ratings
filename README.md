# ITMO Ratings Scraper

Сервис для мониторинга рейтинговых списков поступающих в магистратуру ИТМО и отправки уведомлений в Telegram.

## Описание

Приложение собирает данные о рейтинговых списках со всех программ магистратуры ИТМО, находит указанного студента и отправляет сводку о его позициях во всех программах, куда он подал документы.

Для каждой программы отображается:
- Приоритет заявления студента
- Название программы (с ссылкой)
- Позиция в рейтинге / количество бюджетных мест
- Общее количество поданных заявлений
- Количество студентов с более низким приоритетом, но лучшей позицией
- Время последнего обновления рейтинга

## Пример сообщения

```
Приоритет: 1
Программа: 01.04.01 «Компьютерные системы и технологии»
Позиция: 12 / 26 (всего подано заявлений: 112)
Студентов с приоритетов ниже чем у студента: 10
Последнее обновление: 26 Jul 25 17:43 +0300

Приоритет: 2
Программа: 09.04.04 «Нейротехнологии и программная инженерия»
Позиция: 10 / 30 (всего подано заявлений: 48)
Студентов с приоритетов ниже чем у студента: 9
Последнее обновление: 26 Jul 25 17:43 +0300
```

## Конфигурация

Настройка через переменные окружения:

```env
TELEGRAM_API_TOKEN=your_telegram_bot_token
STUDENT_ID=student_sspv_id
TELEGRAM_USER_ID=telegram_user_id
PROGRAM_ID=program_id  # (не используется в текущей версии)
```

## Запуск

### Docker
```bash
docker build -t itmo-ratings .
docker run --env-file .env itmo-ratings ./rating-scrapper
```

### Локально
```bash
go run cmd/rating-scrapper/main.go
```

## Автоматизация

Приложение предназначено для запуска по расписанию через:
- **Cron**: добавьте задачу для периодического выполнения
- **Coolify Scheduled Tasks**: настройте расписание в интерфейсе Coolify

Рекомендуемая частота запуска: каждые 30-60 минут в период обновления рейтингов.

## Архитектура

- [`cmd/rating-scrapper/main.go`](cmd/rating-scrapper/main.go ) - точка входа
- [`internal/domain/rating/scrapper/service.go`](internal/domain/rating/scrapper/service.go ) - парсинг данных с сайта ИТМО
- [`internal/domain/rating/sender/service.go`](internal/domain/rating/student_rating_service/service.go ) - основная бизнес-логика
- [`internal/infrustructure/bot/bot.go`](internal/infrustructure/bot/bot.go ) - отправка сообщений в Telegram